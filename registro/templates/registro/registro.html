<!DOCTYPE html>
{% load static %}

<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro</title>

    <!-- Favicon -->
    <link rel="icon" href="{% static 'images/icono.ico' %}" type="image/x-icon">

    <!-- tailwindcss -->
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>

    <!-- sweet alert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        /* Estilos adicionales para ocultar y mostrar pasos */
        .step {
            display: none;
        }

        .step.active {
            display: block;
        }
    </style>
</head>

<body class="backdrop-filter backdrop-blur-md"
    style="background-image: url('https://i.pinimg.com/736x/6b/dc/e5/6bdce53334253b7f0d9d5e58b16491bb.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat;">

    <header
        class="fixed flex items-center justify-between w-full text-black md:px-20 md:py-4 text-white px-4 py-4 backdrop-filter backdrop-blur-lg bg-black/50 bg-opacity-60">
        <div class="flex items-end space-x-1 justify-center ">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/cb/Logo_UNAP.png?National_University_of_the_Altiplano1139965787"
                alt="logo unap" class="h-17">
            <img src="{% static 'images/logo-cimac.png' %}" alt="logo cimac" class="h-17 ml-2">
        </div>
        <nav class="flex items-center md:text-md sm:text-sm">
            <a href="/" class="p-2 hover:bg-black/50 cursor-pointer">Regresar</a>
        </nav>
    </header>

    <main class="h-screen items-center justify-center flex flex-col">

        <!-- FORMULARIO DE INSCRIPCION -->
        <form id="registroForm" method="POST" enctype="multipart/form-data"
            class="bg-white p-8 rounded-2xl shadow-md mt-20 max-w-lg w-full">
            {% csrf_token %}

            <!-- PASO 1: Información de montos y fechas -->
            <div class="step active" id="step1">
                <!-- CUENTAS -->
                <div class="px-8 mt-4 max-w-lg w-full">
                    <h1 class="text-center text-2xl font-bold mb-4">CUENTAS</h1>

                    <span class="text-lg font-bold">BCP:</span>
                    <span class="text-lg text-gray-700 ml-1">945-05966479-0-23</span>
                    <br>
                    <span class="text-lg font-bold">CCI:</span>
                    <span class="text-lg text-gray-700 ml-2">002 49510596647902300</span>
                </div>

                <!-- MONTOS -->
                <div class="p-8 mt-4 max-w-lg w-full">
                    <h1 class="text-center text-2xl font-bold mb-4">MONTOS</h1>
                    <h1 class="text-lg font-bold">PARTICIPANTE</h1>
                    <h2>S/. 100 (abril a mayo)</h2>
                    <h2>S/. 150 (junio en adelante)</h2>

                    <h1 class="text-lg font-bold mt-4">ESTUDIANTE (pregrado)</h1>
                    <h2>S/. 50 (abril a mayo)</h2>
                    <h2>S/. 80 (junio en adelante)</h2>
                </div>

                <button type="button" id="nextStep1"
                    class="mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                    Siguiente
                </button>

            </div>

            <!-- PASO 2: Información de procedencia -->
            <div class="step" id="step2">
                <h1 class="text-center text-2xl font-bold mb-4">INSCRIPCION</h1>

                <div class="mb-2">
                    <label for="pais" class="text-gray-700 font-semibold">PAIS:</label>
                    {{ form.pais }}
                </div>

                <div class="mb-2">
                    <label for="entidad_procedencia" class="text-gray-700 font-semibold">ENTIDAD DE PROCEDENCIA:</label>
                    {{ form.entidad_procedencia }}
                </div>

                <div class="mb-2">
                    <label for="tipo_participante" class="text-gray-700 font-semibold">TIPO DE PARTICIPANTE</label>
                    {{ form.tipo_participante }}
                </div>

                <button type="button" id="nextStep2"
                    class="mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                    Siguiente
                </button>

            </div>

            <!-- PASO 3: Información personal -->
            <div class="step" id="step3">
                <h1 class="text-center text-2xl font-bold mb-4">INSCRIPCION</h1>

                <div class="mb-2">
                    <label for="dni" class="text-gray-700 font-semibold">DNI:</label>
                    {{ form.dni }}
                </div>

                <div class="mb-2">
                    <label for="nombres" class="text-gray-700 font-semibold">NOMBRES:</label>
                    {{ form.nombres }}
                </div>

                <div class="mb-2">
                    <label for="apellido_paterno" class="text-gray-700 font-semibold">APELLIDO PATERNO:</label>
                    {{ form.apellido_paterno }}
                </div>

                <div class="mb-2">
                    <label for="apellido_materno" class="text-gray-700 font-semibold">APELLIDO MATERNO:</label>
                    {{ form.apellido_materno }}
                </div>

                <div class="mb-2">
                    <label for="email" class="text-gray-700 font-semibold">EMAIL:</label>
                    {{ form.email }}
                </div>

                <div class="mb-2">
                    <label for="celular" class="text-gray-700 font-semibold">CELULAR:</label>
                    {{ form.celular }}
                </div>

                <button type="button" id="nextStep3"
                    class="mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                    Siguiente
                </button>
            </div>

            <!-- PASO 4: Información de pago -->
            <div class="step" id="step4">
                <h1 class="text-center text-2xl font-bold mb-4">INSCRIPCION</h1>

                <h1 class="text-lg">MONTO A PAGAR:</h1>
                <div class="form-control mt-1 w-full border p-3 rounded-md bg-gray-100 mb-2" id="monto_pago">
                    S/. 100
                </div>

                <div class="mb-2">
                    <label for="voucher_pago" class="flex-1 text-gray-700 font-semibold">VOUCHER DE PAGO:</label>
                    <div class="flex">
                        {{ form.voucher_pago }}
                    </div>
                </div>

                <button type="submit" class="mt-4 w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                    Inscribirme
                </button>

            </div>

        </form>

    </main>

</body>

<script>
    document.addEventListener("DOMContentLoaded", function () {

        const nextStep1Btn = document.getElementById("nextStep1");
        const nextStep2Btn = document.getElementById("nextStep2");
        const nextStep3Btn = document.getElementById("nextStep3");
        const nextStep4Btn = document.getElementById("nextStep4");
        const nextStep5Btn = document.getElementById("nextStep5");

        const step1 = document.getElementById("step1");
        const step2 = document.getElementById("step2");
        const step3 = document.getElementById("step3");
        const step4 = document.getElementById("step4");
        const step5 = document.getElementById("step5");

        // PASO 1
        nextStep1Btn.addEventListener("click", function () {
            Swal.fire({
                icon: 'info',
                title: 'Por favor, asegurese de tener la imagen del pago',
                confirmButtonText: 'Aceptar',
            })
                .then((result) => {
                    if (result.isConfirmed) {
                        step1.classList.remove("active");
                        step2.classList.add("active");
                    }
                });
        });

        // PASO 2
        nextStep2Btn.addEventListener("click", function () {
            const { isValid } = validarFormularioStep2();

            if (isValid) {
                step2.classList.remove("active");
                step3.classList.add("active");
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Por favor, corrija los errores antes de continuar',
                    confirmButtonText: 'Aceptar',
                });
            }
        });

        // PASO 3
        nextStep3Btn.addEventListener("click", function () {
            const { isValid } = validarFormularioStep3();

            if (isValid) {
                step3.classList.remove("active");
                step4.classList.add("active");
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Por favor, corrija los errores antes de continuar',
                    confirmButtonText: 'Aceptar',
                });
            }
        });

        // PASO 4
        nextStep4Btn.addEventListener("click", function () {
            const { isValid } = validarFormularioStep4();

            if (!isValid) {
                Swal.fire({
                    icon: 'error',
                    title: 'Por favor, corrija los errores antes de continuar',
                    confirmButtonText: 'Aceptar',
                });
            }
        });

    });

    function validarFormularioStep2() {
        let isValid = true;
        const fields = [
            { id: 'id_pais', type: 'text', name: 'Pais' },
            { id: 'id_entidad_procedencia', type: 'text', name: 'Entidad de Procedencia' },
            { id: 'id_tipo_participante', type: 'text', name: 'Tipo de Participante' },
        ];

        fields.forEach(function (field) {
            const inputElement = document.getElementById(field.id);
            const value = inputElement.value.trim();

            // Validación de campo no vacío
            if (!value) {
                isValid = false;
            }
        });

        return { isValid };
    }

    function validarFormularioStep3() {
        let isValid = true;
        const fields = [
            { id: 'id_dni', type: 'integer', name: 'DNI' },
            { id: 'id_nombres', type: 'text', name: 'Nombres' },
            { id: 'id_apellido_paterno', type: 'text', name: 'Apellido Paterno' },
            { id: 'id_apellido_materno', type: 'text', name: 'Apellido Materno' },
            { id: 'id_email', type: 'email', name: 'Email' },
            { id: 'id_celular', type: 'integer', name: 'Celular' }
        ];

        fields.forEach(function (field) {
            const inputElement = document.getElementById(field.id);
            const value = inputElement.value.trim();

            // Validación de campo no vacío
            if (!value) {
                isValid = false;
            }
        });

        return { isValid };
    }

    function validarFormularioStep4(event) {
        let isValid = true;

        // Campos a validar
        const fields = [
            { id: 'id_voucher_pago', type: 'file', name: 'VOUCHER DE PAGO' },
        ];

        fields.forEach(function (field) {
            const inputElement = document.getElementById(field.id);
            let value;

            // Validación para campos de tipo file
            if (field.type === 'file') {
                value = inputElement.files.length; // Verificar si se seleccionó un archivo
            } else {
                value = inputElement.value.trim();
            }

            // Validación de campo no vacío
            if (!value) {
                isValid = false;
                alert(`Por favor, ingresa el campo: ${field.name}`);
            }
        });

        // Si es válido, enviar el formulario
        if (!isValid) {
            event.preventDefault();  // Evitar el envío del formulario si hay un error
        }

        return isValid;
    }



</script>

</html>